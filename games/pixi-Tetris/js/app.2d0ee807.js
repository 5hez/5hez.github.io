(function(n){function t(t){for(var i,a,u=t[0],s=t[1],c=t[2],l=0,d=[];l<u.length;l++)a=u[l],r[a]&&d.push(r[a][0]),r[a]=0;for(i in s)Object.prototype.hasOwnProperty.call(s,i)&&(n[i]=s[i]);f&&f(t);while(d.length)d.shift()();return o.push.apply(o,c||[]),e()}function e(){for(var n,t=0;t<o.length;t++){for(var e=o[t],i=!0,u=1;u<e.length;u++){var s=e[u];0!==r[s]&&(i=!1)}i&&(o.splice(t--,1),n=a(a.s=e[0]))}return n}var i={},r={app:0},o=[];function a(t){if(i[t])return i[t].exports;var e=i[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,a),e.l=!0,e.exports}a.m=n,a.c=i,a.d=function(n,t,e){a.o(n,t)||Object.defineProperty(n,t,{enumerable:!0,get:e})},a.r=function(n){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},a.t=function(n,t){if(1&t&&(n=a(n)),8&t)return n;if(4&t&&"object"===typeof n&&n&&n.__esModule)return n;var e=Object.create(null);if(a.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:n}),2&t&&"string"!=typeof n)for(var i in n)a.d(e,i,function(t){return n[t]}.bind(null,i));return e},a.n=function(n){var t=n&&n.__esModule?function(){return n["default"]}:function(){return n};return a.d(t,"a",t),t},a.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},a.p="/games/pixi-Tetris/";var u=window["webpackJsonp"]=window["webpackJsonp"]||[],s=u.push.bind(u);u.push=t,u=u.slice();for(var c=0;c<u.length;c++)t(u[c]);var f=s;o.push(["b92e","chunk-vendors"]),e()})({2207:function(n,t,e){},"70ea":function(n,t,e){},"787c":function(n,t,e){"use strict";var i=e("70ea"),r=e.n(i);r.a},"88e6":function(n,t,e){"use strict";var i=e("2207"),r=e.n(i);r.a},a6e4:function(n,t,e){},b92e:function(n,t,e){"use strict";e.r(t);e("cadf"),e("551c"),e("097d");var i=e("3a34"),r=e.n(i),o=(e("5cfb"),e("2b0e")),a=function(){var n=this,t=n.$createElement,e=n._self._c||t;return e("div",{attrs:{id:"app"}},[e("div",{staticClass:"content"},[e("div",{staticClass:"name"},[n._v("pixi-Tetris")]),e("div",{staticClass:"menu"},[e("div",{staticClass:"btn",on:{click:n.restart}},[n._v("new game")]),e("div",{staticClass:"btn",on:{click:n.pause}},[n._v("pause")]),e("div",{staticClass:"btn",on:{click:n.guide}},[n._v("use guide")])])]),e("div",{ref:"box",staticClass:"box",attrs:{id:"box"}},[e("ul",{staticClass:"tetris-bg",attrs:{id:"tetris-bg"}},n._l(200,function(n,t){return e("li",{key:t})}),0),e("div",{attrs:{id:"tetris"}})]),e("game-over",{directives:[{name:"show",rawName:"v-show",value:n.data.isGameOver,expression:"data.isGameOver"}]}),e("div",{staticClass:"control"},[e("div",{staticClass:"btn up",on:{click:n.up}},[n._v("↑")])]),e("div",{staticClass:"control"},[e("div",{staticClass:"btn left",on:{click:n.left}},[n._v("←")]),e("div",{staticClass:"btn down",on:{click:n.down}},[n._v("↓")]),e("div",{staticClass:"btn right",on:{click:n.right}},[n._v("→")])])],1)},u=[],s=(e("55dd"),e("7514"),e("5df3"),e("4f7f"),e("2909")),c=(e("20d6"),e("ac6a"),e("22a2")),f=e("2ef0"),l=e.n(f),d=e("bbaf"),v=e.n(d),g={};function h(){g.boxId="tetris-bg",g.docId="tetris",g.delay=1e3,g.currentScore=0,g.highestScore=0,g.isGameOver=!1,g.guide=!0}h();var y=g;function m(n){var t={};return t.code=n,t.release=void 0,t.upHandler=function(n){n.keyCode===t.code&&t.release&&t.release(),n.preventDefault()},window.addEventListener("keyup",t.upHandler.bind(t),!1),t}function p(n,t){return Math.floor(Math.random()*(t-n+1))+n}function x(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12;return+parseFloat(n.toPrecision(t))}function C(n,t,e){return"down"===e?Math.abs(t.y+t.height-n.y)<=2:"left"===e?Math.abs(t.x-t.width-n.x)<=2:"right"===e?Math.abs(t.x+t.width-n.x)<=2:void 0}var b=[[{x:0,y:0},{x:1,y:0},{x:1,y:1},{x:2,y:1},{x:1,y:1}],[{x:0,y:1},{x:1,y:1},{x:1,y:0},{x:2,y:0},{x:1,y:1}],[{x:0,y:1},{x:0,y:0},{x:1,y:1},{x:2,y:1},{x:1,y:1}],[{x:0,y:1},{x:2,y:0},{x:1,y:1},{x:2,y:1},{x:1,y:1}],[{x:0,y:1},{x:1,y:0},{x:1,y:1},{x:2,y:1},{x:1,y:1}],[{x:0,y:0},{x:3,y:0},{x:1,y:0},{x:2,y:0},{x:1,y:0}],[{x:0,y:0},{x:1,y:0},{x:0,y:1},{x:1,y:1},{x:0,y:0}]],w=null,O={app:_,pause:W,isPause:!1,delayId:null};function _(){h(),O.dpr=window.devicePixelRatio,O.width=document.getElementById(y.boxId).clientWidth*O.dpr,O.spriteWidth=x(O.width/10),O.containerOffset=3,O.speed=O.spriteWidth,O.movingContainer=new c["b"],R(),w=new c["a"]({width:this.width,height:2*this.width,transparent:!0}),document.getElementById(y.docId).replaceWith(w.view),w.renderer.view.id=y.docId,w.renderer.view.style.verticalAlign="top",w.renderer.view.style.transform="scale(".concat(1/O.dpr,")"),w.renderer.view.style.transformOrigin="0 0",w.renderer.view.style.position="absolute",w.renderer.view.style.top="0",w.renderer.view.style.left="0",w.stage.addChild(O.movingContainer),w.loader.add([v.a]).on("progress",P).load(function(){I(),E();w.ticker.add(S)})}function P(n,t){console.log("loading: "+t.url),console.log("progress: "+n.progress+"%")}function E(){B(p(0,b.length-1)),L()}function S(){if(!O.delayId&&(O.delayId=setTimeout(function(){O.delayId=null},y.delay),!O.isPause))if(M())y.isGameOver=!0;else{var n=k();n||(O.movingContainer.y+=O.movingContainer.vy)}}function k(){var n=T();return n&&(y.delay=1e3,J(),G(),B(p(0,b.length-1))),n}function M(){return!!w.stage.children.filter(function(n){return n.isSprite}).filter(function(n){return n.x>=O.spriteWidth*O.containerOffset&&n.x*O.spriteWidth*(O.containerOffset+4)&&n.y<=2}).length}function W(){O.isPause=!O.isPause}function I(){O.texture=c["d"].from(v.a)}function j(n){var t=n.x,e=n.y,i=new c["c"](O.texture);return i.x=x(t),i.y=x(e),i.width=O.spriteWidth,i.height=O.spriteWidth,i.aid=l.a.uniqueId(),i}function B(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i="number"===typeof n?b[n]:O.movingContainer.tetris;"number"===typeof n&&(O.movingContainer.angle=0),i.slice(0,4).map(function(n){return j({x:(n.x-t)*O.spriteWidth,y:(n.y-e)*O.spriteWidth,v:{vx:0,vy:0}})}).forEach(function(n){O.movingContainer.addChild(n)}),O.movingContainer.tetris=i,O.movingContainer.vy=O.speed,"number"===typeof n&&(O.movingContainer.x=x(O.spriteWidth*O.containerOffset),1===l.a.last(i).x&&1===l.a.last(i).y?O.movingContainer.y=-1*O.spriteWidth:O.movingContainer.y=-2*O.spriteWidth),O.isDowning=!1,O.movingContainer.idName=n}function G(){console.log(O.movingContainer),console.log(w.stage.children);var n=l.a.sortBy(w.stage.children.filter(function(n){return n.isSprite}),["y"]).reverse();if(n.length){var t=[[n[0]]];n.slice(1).forEach(function(n){var e=t.findIndex(function(t){return Math.abs(t[0].y-n.y)<2});if(-1!==e)t[e].push(n);else{var i=[n];t.push(i)}}),t.forEach(function(t,e){if(10===t.length){var i=0;O.isPause=!0;var r=setInterval(function(){t.forEach(function(n){n.alpha=i%2?.5:1}),i>3&&(clearInterval(r),t.forEach(function(n){w.stage.removeChild(n)}),n.filter(function(n){return n.y<t[0].y}).forEach(function(n){n.y+=O.spriteWidth}),O.isPause=!1),++i},300)}})}}function T(){O.movingContainer.children.forEach(function(n){return n.tint=16777215});var n=w.stage.children.filter(function(n){return n.isSprite});if(n.length){var t=Object(s["a"])(new Set(O.movingContainer.children.map(function(n){return n.x+O.movingContainer.x}))),e=t.map(function(n){return l.a.last(l.a.sortBy(O.movingContainer.children.filter(function(t){return t.x+O.movingContainer.x===n}),["y"]))}),i=n.filter(function(n){return t.some(function(t){return Math.abs(t-n.x)<2})});if(i.length){var r=e.map(function(n){return l.a.first(l.a.sortBy(i.filter(function(t){return Math.abs(t.x-n.x-O.movingContainer.x)<2&&t.y-n.y-O.movingContainer.y>=-1}),["y"]))});return l.a.compact(r).length?N(r,e):q()}return w.stage.children.filter(function(n){return n.isSprite}).forEach(function(n){return n.tint=16777215}),q()}return q()}function D(){O.movingContainer.children.forEach(function(n){return n.tint=16777215});var n=w.stage.children.filter(function(n){return n.isSprite});if(n.length){var t=Object(s["a"])(new Set(O.movingContainer.children.map(function(n){return n.y+O.movingContainer.y}))),e=t.map(function(n){return l.a.last(l.a.sortBy(O.movingContainer.children.filter(function(t){return t.y+O.movingContainer.y===n}),["x"]))}),i=n.filter(function(n){return t.find(function(t){return Math.abs(t-n.y)<2})});if(i.length){var r=e.map(function(n){return l.a.first(l.a.sortBy(i.filter(function(t){return Math.abs(t.y-n.y-O.movingContainer.y)<2}),["x"]))});return F(r,e)}return null}return null}function A(){O.movingContainer.children.forEach(function(n){return n.tint=16777215});var n=w.stage.children.filter(function(n){return n.isSprite});if(n.length){var t=Object(s["a"])(new Set(O.movingContainer.children.map(function(n){return n.y+O.movingContainer.y}))),e=t.map(function(n){return l.a.first(l.a.sortBy(O.movingContainer.children.filter(function(t){return t.y+O.movingContainer.y===n}),["x"]))}),i=n.filter(function(n){return t.find(function(t){return Math.abs(t-n.y)<2})});if(i.length){var r=e.map(function(n){return l.a.last(l.a.sortBy(i.filter(function(t){return Math.abs(t.y-n.y-O.movingContainer.y)<2}),["x"]))});return $(r,e)}return null}return null}function N(n,t){return w.stage.children.filter(function(n){return n.isSprite}).forEach(function(n){return n.tint=16777215}),O.movingContainer&&O.movingContainer.children.forEach(function(n){return n.tint=16777215}),t.some(function(t){if(!t)return!1;var e=n.find(function(n){return n&&Math.abs(t.x+O.movingContainer.x-n.x)<2});return!!e&&(y.guide&&(e.tint=16711680),y.guide&&(t.tint=130816),C(e,{x:t.x+O.movingContainer.x,y:t.y+O.movingContainer.y,width:t.width,height:t.height},"down"))})?"hit":null}function F(n,t){return w.stage.children.filter(function(n){return n.isSprite}).forEach(function(n){return n.tint=16777215}),O.movingContainer&&O.movingContainer.children.forEach(function(n){return n.tint=16777215}),t.some(function(t){if(!t)return!1;var e=n.find(function(n){return n&&Math.abs(t.y+O.movingContainer.y-n.y)<2});return!!e&&(y.guide&&(e.tint=9437352),y.guide&&(t.tint=130816),C(e,{x:t.x+O.movingContainer.x,y:t.y+O.movingContainer.y,width:t.width,height:t.height},"right"))})?"hit-right":null}function $(n,t){return w.stage.children.filter(function(n){return n.isSprite}).forEach(function(n){return n.tint=16777215}),O.movingContainer&&O.movingContainer.children.forEach(function(n){return n.tint=16777215}),t.some(function(t){if(!t)return!1;var e=n.find(function(n){return n&&Math.abs(t.y+O.movingContainer.y-n.y)<2});return!!e&&(y.guide&&(e.tint=15746),y.guide&&(t.tint=130816),C(e,{x:t.x+O.movingContainer.x,y:t.y+O.movingContainer.y,width:t.width,height:t.height},"left"))})?"hit-left":null}function q(){return H(O.movingContainer,{height:w.renderer.height})}function H(n,t){var e=null,i=K(),r=U("y").sort(function(n,t){return n-t<0?-1:1})[0];return x(O.movingContainer.y+r+i)>=x(t.height)&&(n.vy=0,e="bottom"),e}function J(){while(O.movingContainer.children[0]){var n=O.movingContainer.children[0];n.y+=O.movingContainer.y,n.x+=O.movingContainer.x,n.tint=16777215,w.stage.addChild(n)}}function L(){m(37).release=O.movingContainer.left,m(38).release=O.movingContainer.up,m(39).release=O.movingContainer.right,m(40).release=O.movingContainer.down}function R(){O.movingContainer.left=function(){O.isDowning||O.isPause||O.movingContainer.x+Q()[0].x-O.spriteWidth<-1||(O.isPause=!0,A()?O.isPause=!1:(O.movingContainer.x=x(O.movingContainer.x-O.spriteWidth),O.isPause=!1,k()))},O.movingContainer.right=function(){O.isDowning||O.isPause||O.movingContainer.x+Q()[0].x+z()>O.width-1||(O.isPause=!0,D()?O.isPause=!1:(O.movingContainer.x+=O.spriteWidth,O.isPause=!1,k()))},O.movingContainer.down=function(){O.isDowning||O.isPause||(O.isDowning=!0,y.delay=10,clearTimeout(O.delayId),O.delayId=null,k())},O.movingContainer.up=function(){O.isDowning||V(O.movingContainer.idName)}}function z(){return U("x").length*O.spriteWidth}function K(){return U("y").length*O.spriteWidth}function Q(){var n=l.a.sortBy(U("x"))[0];return l.a.sortBy(O.movingContainer.children,["x"]).filter(function(t){return t.x===n})}function U(n){return Object(s["a"])(new Set(O.movingContainer.children.map(function(t){return t[n]})))}function V(){var n=O.movingContainer.tetris,t=n.slice(0,4),e=n[4],i=0;if(0!==e.x||0!==e.y){1===e.x&&0===e.y&&(i=1);var r=t.map(function(n){return{x:e.x+e.y-n.y+i,y:n.x+e.y-e.x}});r.push(e),r.push(e),O.movingContainer.tetris=r,O.movingContainer.removeChildren(),B("rotate")}}var X=O,Y=function(){var n=this,t=n.$createElement,e=n._self._c||t;return e("div",{staticClass:"game-over"},[e("div",{staticClass:"text"},[n._v("game over!")]),e("div",{staticClass:"btn",on:{click:n.newGame}},[n._v("new game")])])},Z=[],nn={name:"GameOver",props:{},methods:{newGame:function(){X.app()}}},tn=nn,en=(e("787c"),e("2877")),rn=Object(en["a"])(tn,Y,Z,!1,null,"2fdcc750",null);rn.options.__file="gameover.vue";var on=rn.exports,an={name:"Games-Tetris",components:{GameOver:on},data:function(){return{data:y,pixi:X}},mounted:function(){X.app()},methods:{restart:function(){X.app()},pause:function(){X.pause()},guide:function(){this.data.guide=!this.data.guide},up:function(){X.movingContainer.up()},left:function(){X.movingContainer.left()},right:function(){X.movingContainer.right()},down:function(){X.movingContainer.down()}}},un=an,sn=(e("be3b"),e("88e6"),Object(en["a"])(un,a,u,!1,null,"3f094efe",null));sn.options.__file="App.vue";var cn=sn.exports,fn=e("9483");Object(fn["a"])("".concat("/games/pixi-Tetris/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},cached:function(){console.log("Content has been cached for offline use.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(n){console.error("Error during service worker registration:",n)}}),o["a"].config.productionTip=!1,new r.a,new o["a"]({render:function(n){return n(cn)}}).$mount("#app")},bbaf:function(n,t,e){n.exports=e.p+"img/one.7e78d10c.png"},be3b:function(n,t,e){"use strict";var i=e("a6e4"),r=e.n(i);r.a}});
//# sourceMappingURL=app.2d0ee807.js.map
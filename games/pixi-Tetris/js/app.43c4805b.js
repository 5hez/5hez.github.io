(function(n){function t(t){for(var i,a,u=t[0],s=t[1],c=t[2],l=0,d=[];l<u.length;l++)a=u[l],r[a]&&d.push(r[a][0]),r[a]=0;for(i in s)Object.prototype.hasOwnProperty.call(s,i)&&(n[i]=s[i]);f&&f(t);while(d.length)d.shift()();return o.push.apply(o,c||[]),e()}function e(){for(var n,t=0;t<o.length;t++){for(var e=o[t],i=!0,u=1;u<e.length;u++){var s=e[u];0!==r[s]&&(i=!1)}i&&(o.splice(t--,1),n=a(a.s=e[0]))}return n}var i={},r={app:0},o=[];function a(t){if(i[t])return i[t].exports;var e=i[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,a),e.l=!0,e.exports}a.m=n,a.c=i,a.d=function(n,t,e){a.o(n,t)||Object.defineProperty(n,t,{enumerable:!0,get:e})},a.r=function(n){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},a.t=function(n,t){if(1&t&&(n=a(n)),8&t)return n;if(4&t&&"object"===typeof n&&n&&n.__esModule)return n;var e=Object.create(null);if(a.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:n}),2&t&&"string"!=typeof n)for(var i in n)a.d(e,i,function(t){return n[t]}.bind(null,i));return e},a.n=function(n){var t=n&&n.__esModule?function(){return n["default"]}:function(){return n};return a.d(t,"a",t),t},a.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},a.p="/games/pixi-Tetris/";var u=window["webpackJsonp"]=window["webpackJsonp"]||[],s=u.push.bind(u);u.push=t,u=u.slice();for(var c=0;c<u.length;c++)t(u[c]);var f=s;o.push(["b92e","chunk-vendors"]),e()})({2207:function(n,t,e){},"70ea":function(n,t,e){},"787c":function(n,t,e){"use strict";var i=e("70ea"),r=e.n(i);r.a},"88e6":function(n,t,e){"use strict";var i=e("2207"),r=e.n(i);r.a},a6e4:function(n,t,e){},b92e:function(n,t,e){"use strict";e.r(t);e("cadf"),e("551c"),e("097d"),e("5cfb");var i=e("2b0e"),r=function(){var n=this,t=n.$createElement,e=n._self._c||t;return e("div",{attrs:{id:"app"}},[e("div",{staticClass:"content"},[e("div",{staticClass:"name"},[n._v("pixi-Tetris")]),e("div",{staticClass:"menu"},[e("div",{staticClass:"btn",on:{click:n.restart}},[n._v("new game")]),e("div",{staticClass:"btn",on:{click:n.pause}},[n._v("pause")]),e("div",{staticClass:"btn",on:{click:n.guide}},[n._v("use guide")])])]),e("div",{ref:"box",staticClass:"box",attrs:{id:"box"}},[e("ul",{staticClass:"tetris-bg",attrs:{id:"tetris-bg"}},n._l(200,function(n,t){return e("li",{key:t})}),0),e("div",{attrs:{id:"tetris"}})]),e("game-over",{directives:[{name:"show",rawName:"v-show",value:n.data.isGameOver,expression:"data.isGameOver"}]}),e("div",{staticClass:"control"},[e("div",{staticClass:"btn up",on:{click:n.up}},[n._v("↑")])]),e("div",{staticClass:"control"},[e("div",{staticClass:"btn left",on:{click:n.left}},[n._v("←")]),e("div",{staticClass:"btn down",on:{click:n.down}},[n._v("↓")]),e("div",{staticClass:"btn right",on:{click:n.right}},[n._v("→")])])],1)},o=[],a=(e("55dd"),e("7514"),e("5df3"),e("4f7f"),e("2909")),u=(e("20d6"),e("ac6a"),e("22a2")),s=e("2ef0"),c=e.n(s),f=e("bbaf"),l=e.n(f),d={};function v(){d.boxId="tetris-bg",d.docId="tetris",d.delay=1e3,d.currentScore=0,d.highestScore=0,d.isGameOver=!1,d.guide=!0}v();var h=d;function g(n){var t={};return t.code=n,t.release=void 0,t.upHandler=function(n){n.keyCode===t.code&&t.release&&t.release(),n.preventDefault()},window.addEventListener("keyup",t.upHandler.bind(t),!1),t}function y(n,t){return Math.floor(Math.random()*(t-n+1))+n}function m(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12;return+parseFloat(n.toPrecision(t))}function p(n,t,e){return"down"===e?Math.abs(t.y+t.height-n.y)<=2:"left"===e?Math.abs(t.x-t.width-n.x)<=2:"right"===e?Math.abs(t.x+t.width-n.x)<=2:void 0}var x=[[{x:0,y:0},{x:1,y:0},{x:1,y:1},{x:2,y:1},{x:1,y:1}],[{x:0,y:1},{x:1,y:1},{x:1,y:0},{x:2,y:0},{x:1,y:1}],[{x:0,y:1},{x:0,y:0},{x:1,y:1},{x:2,y:1},{x:1,y:1}],[{x:0,y:1},{x:2,y:0},{x:1,y:1},{x:2,y:1},{x:1,y:1}],[{x:0,y:1},{x:1,y:0},{x:1,y:1},{x:2,y:1},{x:1,y:1}],[{x:0,y:0},{x:3,y:0},{x:1,y:0},{x:2,y:0},{x:1,y:0}],[{x:0,y:0},{x:1,y:0},{x:0,y:1},{x:1,y:1},{x:0,y:0}]],C=null,b={app:w,pause:S,isPause:!1,delayId:null};function w(){v(),b.dpr=window.devicePixelRatio,b.width=document.getElementById(h.boxId).clientWidth*b.dpr,b.spriteWidth=m(b.width/10),b.containerOffset=3,b.speed=b.spriteWidth,b.movingContainer=new u["b"],J(),C=new u["a"]({width:this.width,height:2*this.width,transparent:!0}),document.getElementById(h.docId).replaceWith(C.view),C.renderer.view.id=h.docId,C.renderer.view.style.verticalAlign="top",C.renderer.view.style.transform="scale(".concat(1/b.dpr,")"),C.renderer.view.style.transformOrigin="0 0",C.renderer.view.style.position="absolute",C.renderer.view.style.top="0",C.renderer.view.style.left="0",C.stage.addChild(b.movingContainer),C.loader.add([l.a]).on("progress",W).load(function(){k(),O();C.ticker.add(_)})}function W(n,t){console.log("loading: "+t.url),console.log("progress: "+n.progress+"%")}function O(){I(y(0,x.length-1)),H()}function _(){if(!b.delayId&&(b.delayId=setTimeout(function(){b.delayId=null},h.delay),!b.isPause))if(P())h.isGameOver=!0;else{var n=E();n||(b.movingContainer.y+=b.movingContainer.vy)}}function E(){var n=B();return n&&(h.delay=1e3,q(),j(),I(y(0,x.length-1))),n}function P(){return!!C.stage.children.filter(function(n){return n.isSprite}).filter(function(n){return n.x>=b.spriteWidth*b.containerOffset&&n.x*b.spriteWidth*(b.containerOffset+4)&&n.y<=2}).length}function S(){b.isPause=!b.isPause}function k(){b.texture=u["d"].from(l.a)}function M(n){var t=n.x,e=n.y,i=new u["c"](b.texture);return i.x=m(t),i.y=m(e),i.width=b.spriteWidth,i.height=b.spriteWidth,i.aid=c.a.uniqueId(),i}function I(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i="number"===typeof n?x[n]:b.movingContainer.tetris;"number"===typeof n&&(b.movingContainer.angle=0),i.slice(0,4).map(function(n){return M({x:(n.x-t)*b.spriteWidth,y:(n.y-e)*b.spriteWidth,v:{vx:0,vy:0}})}).forEach(function(n){b.movingContainer.addChild(n)}),b.movingContainer.tetris=i,b.movingContainer.vy=b.speed,"number"===typeof n&&(b.movingContainer.x=m(b.spriteWidth*b.containerOffset),1===c.a.last(i).x&&1===c.a.last(i).y?b.movingContainer.y=-1*b.spriteWidth:b.movingContainer.y=-2*b.spriteWidth),b.isDowning=!1,b.movingContainer.idName=n}function j(){var n=c.a.sortBy(C.stage.children.filter(function(n){return n.isSprite}),["y"]).reverse();if(n.length){var t=[[n[0]]];n.slice(1).forEach(function(n){var e=t.findIndex(function(t){return Math.abs(t[0].y-n.y)<2});if(-1!==e)t[e].push(n);else{var i=[n];t.push(i)}}),t.forEach(function(t,e){if(10===t.length){var i=0;b.isPause=!0;var r=setInterval(function(){t.forEach(function(n){n.alpha=i%2?.5:1}),i>3&&(clearInterval(r),t.forEach(function(n){C.stage.removeChild(n)}),n.filter(function(n){return n.y<t[0].y}).forEach(function(n){n.y+=b.spriteWidth}),b.isPause=!1),++i},300)}})}}function B(){b.movingContainer.children.forEach(function(n){return n.tint=16777215});var n=C.stage.children.filter(function(n){return n.isSprite});if(n.length){var t=Object(a["a"])(new Set(b.movingContainer.children.map(function(n){return n.x+b.movingContainer.x}))),e=t.map(function(n){return c.a.last(c.a.sortBy(b.movingContainer.children.filter(function(t){return t.x+b.movingContainer.x===n}),["y"]))}),i=n.filter(function(n){return t.some(function(t){return Math.abs(t-n.x)<2})});if(i.length){var r=e.map(function(n){return c.a.first(c.a.sortBy(i.filter(function(t){return Math.abs(t.x-n.x-b.movingContainer.x)<2&&t.y-n.y-b.movingContainer.y>=-1}),["y"]))});return c.a.compact(r).length?D(r,e):F()}return C.stage.children.filter(function(n){return n.isSprite}).forEach(function(n){return n.tint=16777215}),F()}return F()}function G(){b.movingContainer.children.forEach(function(n){return n.tint=16777215});var n=C.stage.children.filter(function(n){return n.isSprite});if(n.length){var t=Object(a["a"])(new Set(b.movingContainer.children.map(function(n){return n.y+b.movingContainer.y}))),e=t.map(function(n){return c.a.last(c.a.sortBy(b.movingContainer.children.filter(function(t){return t.y+b.movingContainer.y===n}),["x"]))}),i=n.filter(function(n){return t.find(function(t){return Math.abs(t-n.y)<2})});if(i.length){var r=e.map(function(n){return c.a.first(c.a.sortBy(i.filter(function(t){return Math.abs(t.y-n.y-b.movingContainer.y)<2}),["x"]))});return A(r,e)}return null}return null}function T(){b.movingContainer.children.forEach(function(n){return n.tint=16777215});var n=C.stage.children.filter(function(n){return n.isSprite});if(n.length){var t=Object(a["a"])(new Set(b.movingContainer.children.map(function(n){return n.y+b.movingContainer.y}))),e=t.map(function(n){return c.a.first(c.a.sortBy(b.movingContainer.children.filter(function(t){return t.y+b.movingContainer.y===n}),["x"]))}),i=n.filter(function(n){return t.find(function(t){return Math.abs(t-n.y)<2})});if(i.length){var r=e.map(function(n){return c.a.last(c.a.sortBy(i.filter(function(t){return Math.abs(t.y-n.y-b.movingContainer.y)<2}),["x"]))});return N(r,e)}return null}return null}function D(n,t){return C.stage.children.filter(function(n){return n.isSprite}).forEach(function(n){return n.tint=16777215}),b.movingContainer&&b.movingContainer.children.forEach(function(n){return n.tint=16777215}),t.some(function(t){if(!t)return!1;var e=n.find(function(n){return n&&Math.abs(t.x+b.movingContainer.x-n.x)<2});return!!e&&(h.guide&&(e.tint=16711680),h.guide&&(t.tint=130816),p(e,{x:t.x+b.movingContainer.x,y:t.y+b.movingContainer.y,width:t.width,height:t.height},"down"))})?"hit":null}function A(n,t){return C.stage.children.filter(function(n){return n.isSprite}).forEach(function(n){return n.tint=16777215}),b.movingContainer&&b.movingContainer.children.forEach(function(n){return n.tint=16777215}),t.some(function(t){if(!t)return!1;var e=n.find(function(n){return n&&Math.abs(t.y+b.movingContainer.y-n.y)<2});return!!e&&(h.guide&&(e.tint=9437352),h.guide&&(t.tint=130816),p(e,{x:t.x+b.movingContainer.x,y:t.y+b.movingContainer.y,width:t.width,height:t.height},"right"))})?"hit-right":null}function N(n,t){return C.stage.children.filter(function(n){return n.isSprite}).forEach(function(n){return n.tint=16777215}),b.movingContainer&&b.movingContainer.children.forEach(function(n){return n.tint=16777215}),t.some(function(t){if(!t)return!1;var e=n.find(function(n){return n&&Math.abs(t.y+b.movingContainer.y-n.y)<2});return!!e&&(h.guide&&(e.tint=15746),h.guide&&(t.tint=130816),p(e,{x:t.x+b.movingContainer.x,y:t.y+b.movingContainer.y,width:t.width,height:t.height},"left"))})?"hit-left":null}function F(){return $(b.movingContainer,{height:C.renderer.height})}function $(n,t){var e=null,i=R(),r=K("y").sort(function(n,t){return n-t<0?-1:1})[0];return m(b.movingContainer.y+r+i)>=m(t.height)&&(n.vy=0,e="bottom"),e}function q(){while(b.movingContainer.children[0]){var n=b.movingContainer.children[0];n.y+=b.movingContainer.y,n.x+=b.movingContainer.x,n.tint=16777215,C.stage.addChild(n)}}function H(){g(37).release=b.movingContainer.left,g(38).release=b.movingContainer.up,g(39).release=b.movingContainer.right,g(40).release=b.movingContainer.down,g(32).release=S}function J(){b.movingContainer.left=function(){b.isDowning||b.isPause||b.movingContainer.x+z()[0].x-b.spriteWidth<-1||(b.isPause=!0,T()?b.isPause=!1:(b.movingContainer.x=m(b.movingContainer.x-b.spriteWidth),b.isPause=!1,E()))},b.movingContainer.right=function(){b.isDowning||b.isPause||b.movingContainer.x+z()[0].x+L()>b.width-1||(b.isPause=!0,G()?b.isPause=!1:(b.movingContainer.x+=b.spriteWidth,b.isPause=!1,E()))},b.movingContainer.down=function(){b.isDowning||b.isPause||(b.isDowning=!0,h.delay=10,clearTimeout(b.delayId),b.delayId=null,E())},b.movingContainer.up=function(){b.isDowning||Q(b.movingContainer.idName)}}function L(){return K("x").length*b.spriteWidth}function R(){return K("y").length*b.spriteWidth}function z(){var n=c.a.sortBy(K("x"))[0];return c.a.sortBy(b.movingContainer.children,["x"]).filter(function(t){return t.x===n})}function K(n){return Object(a["a"])(new Set(b.movingContainer.children.map(function(t){return t[n]})))}function Q(){var n=b.movingContainer.tetris,t=n.slice(0,4),e=n[4],i=0;if(0!==e.x||0!==e.y){1===e.x&&0===e.y&&(i=1);var r=t.map(function(n){return{x:e.x+e.y-n.y+i,y:n.x+e.y-e.x}});U(r),r.push(e),b.movingContainer.tetris=r,b.movingContainer.removeChildren(),I("rotate")}}function U(n){var t=0,e=0,i=0,r=b.movingContainer.x,o=b.movingContainer.y;n.forEach(function(n){var a=n.x*b.spriteWidth+r;a<0&&(e=1),m(a+b.spriteWidth)>C.renderer.width&&(t=1),m(n.y*b.spriteWidth+o+b.spriteWidth)>C.renderer.height&&(i=1)}),console.log("".concat(e,", ").concat(t,", ").concat(i)),(e||t||i)&&(e&&(b.movingContainer.x-=c.a.first(c.a.sortBy(n,["x"])).x*b.spriteWidth+r),t&&(b.movingContainer.x-=c.a.last(c.a.sortBy(n,["x"])).x*b.spriteWidth+b.spriteWidth+r-C.renderer.width),i&&(b.movingContainer.y-=c.a.last(c.a.sortBy(n,["y"])).y*b.spriteWidth+b.spriteWidth+o-C.renderer.height))}var V=b,X=function(){var n=this,t=n.$createElement,e=n._self._c||t;return e("div",{staticClass:"game-over"},[e("div",{staticClass:"text"},[n._v("game over!")]),e("div",{staticClass:"btn",on:{click:n.newGame}},[n._v("new game")])])},Y=[],Z={name:"GameOver",props:{},methods:{newGame:function(){V.app()}}},nn=Z,tn=(e("787c"),e("2877")),en=Object(tn["a"])(nn,X,Y,!1,null,"2fdcc750",null);en.options.__file="gameover.vue";var rn=en.exports,on={name:"Games-Tetris",components:{GameOver:rn},data:function(){return{data:h,pixi:V}},mounted:function(){V.app()},methods:{restart:function(){V.app()},pause:function(){V.pause()},guide:function(){this.data.guide=!this.data.guide},up:function(){V.movingContainer.up()},left:function(){V.movingContainer.left()},right:function(){V.movingContainer.right()},down:function(){V.movingContainer.down()}}},an=on,un=(e("be3b"),e("88e6"),Object(tn["a"])(an,r,o,!1,null,"3f094efe",null));un.options.__file="App.vue";var sn=un.exports,cn=e("9483");Object(cn["a"])("".concat("/games/pixi-Tetris/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},cached:function(){console.log("Content has been cached for offline use.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(n){console.error("Error during service worker registration:",n)}}),i["a"].config.productionTip=!1,new i["a"]({render:function(n){return n(sn)}}).$mount("#app")},bbaf:function(n,t,e){n.exports=e.p+"img/one.7e78d10c.png"},be3b:function(n,t,e){"use strict";var i=e("a6e4"),r=e.n(i);r.a}});
//# sourceMappingURL=app.43c4805b.js.map